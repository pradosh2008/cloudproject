. ${HOME}/lib/set_env.sh
. ${HOME}/lib/common.sh

#Unique Key Check
sql='select count(*) from (
                SELECT brand_customer_key,email_id
                FROM analytic_mart.plus_brand_customer_email_outbound a
                GROUP BY 1,2
                HAVING COUNT(*)>1
)'
run_validation "$sql" "Unique key  Check"

#Null Key Check
sql='select count(*)  FROM(
                SELECT brand_customer_key
                FROM analytic_mart.plus_brand_customer_email_outbound a
                WHERE brand_customer_key IS NULL or email_id is null
)'
run_validation "$sql" "Null key Check"

#Completeness Check
sql='select count(*) from (
                select eo.brand_customer_key FROM analytic_mart.plus_brand_customer_email_outbound eo
                LEFT JOIN analytic_mart.dim_brand_customer c
                on eo.brand_customer_key = c.brand_customer_key
                where eo.brand_customer_key is null
)'
run_validation "$sql" "Completeness Check"


